# ç³–å°¿ç—…åŒ¿åç»Ÿè®¡åˆ†æå¹³å°

åŸºäº **FHEVM + IPFS + Sepolia** æµ‹è¯•é“¾çš„å»ä¸­å¿ƒåŒ–ç³–å°¿ç—…æ‚£è€…åŒ¿åæ•°æ®ç»Ÿè®¡åˆ†æ DAppã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºç³–å°¿ç—…æ‚£è€…å’ŒåŒ»å­¦ç ”ç©¶å‘˜æä¾›äº†ä¸€ä¸ªå®Œå…¨éšç§ä¿æŠ¤çš„æ•°æ®åˆ†æå¹³å°ï¼š

- **æ‚£è€…ç«¯**ï¼šå®‰å…¨ä¸Šä¼ åŠ å¯†çš„è¡€ç³–æ•°æ®
- **ç ”ç©¶å‘˜ç«¯**ï¼šè¿è¡Œç»Ÿè®¡åˆ†æå¹¶æŸ¥çœ‹å¯è§†åŒ–ç»“æœ
- **éšç§ä¿æŠ¤**ï¼šæ‰€æœ‰æ•°æ®ä½¿ç”¨ FHEVM åŒæ€åŠ å¯†æŠ€æœ¯å¤„ç†
- **å»ä¸­å¿ƒåŒ–å­˜å‚¨**ï¼šåŸå§‹æ•°æ®å­˜å‚¨åœ¨ IPFSï¼Œé“¾ä¸Šä»…ä¿å­˜ CID å’ŒåŠ å¯†ç»“æœ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**ï¼šNext.js 14 + React 18 + TypeScript
- **UI ç»„ä»¶**ï¼šTailwindCSS + Shadcn/UI
- **åŠ¨æ•ˆåº“**ï¼šFramer Motion
- **æ•°æ®å¯è§†åŒ–**ï¼šRecharts
- **åŒºå—é“¾äº¤äº’**ï¼šethers.js v6 + MetaMask
- **æ™ºèƒ½åˆçº¦**ï¼šSolidity + FHEVM (@fhevm/solidity)
- **å»ä¸­å¿ƒåŒ–å­˜å‚¨**ï¼šIPFS (Filebase ç½‘å…³)
- **æµ‹è¯•ç½‘ç»œ**ï¼šSepolia Testnet

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ‚£è€…ç«¯ UI     â”‚    â”‚  ç ”ç©¶å‘˜ç«¯ UI    â”‚
â”‚  (React/Next)   â”‚    â”‚  (React/Next)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
          â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Web3 äº¤äº’å±‚ (ethers.js)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FHEVM åˆçº¦     â”‚    â”‚  IPFS å­˜å‚¨      â”‚
â”‚ (Sepolia é“¾)    â”‚    â”‚  (Filebase)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– yarn
- MetaMask é’±åŒ…
- Sepolia æµ‹è¯•ç½‘ ETH

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd diabetes-fhe-dapp
```

### 2. å®‰è£…ä¾èµ–

```bash
# å®‰è£…åˆçº¦ä¾èµ–
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
```

### 3. ç¯å¢ƒé…ç½®

#### åç«¯é…ç½®

å¤åˆ¶å¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# åŒºå—é“¾é…ç½®
SEPOLIA_RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_KEY
PRIVATE_KEY=your_private_key_here

# IPFS é…ç½®
FILEBASE_API_KEY=your_filebase_api_key
FILEBASE_SECRET_KEY=your_filebase_secret_key
FILEBASE_BUCKET=diabetes-data-bucket
```

#### å‰ç«¯é…ç½®

```bash
cd frontend
cp .env.local.example .env.local
```

ç¼–è¾‘ `frontend/.env.local`ï¼š

```env
NEXT_PUBLIC_CONTRACT_ADDRESS=éƒ¨ç½²åçš„åˆçº¦åœ°å€
NEXT_PUBLIC_SEPOLIA_RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_KEY
NEXT_PUBLIC_FILEBASE_GATEWAY=https://ipfs.filebase.io/ipfs/
```

### 4. éƒ¨ç½²æ™ºèƒ½åˆçº¦

```bash
# ç¼–è¯‘åˆçº¦
npm run compile

# éƒ¨ç½²åˆ° Sepolia æµ‹è¯•ç½‘
npm run deploy
```

éƒ¨ç½²æˆåŠŸåï¼Œå°†åˆçº¦åœ°å€æ›´æ–°åˆ°å‰ç«¯ç¯å¢ƒå˜é‡ä¸­ã€‚

### 5. å¯åŠ¨å‰ç«¯åº”ç”¨

```bash
cd frontend
npm run dev
```

è®¿é—® http://localhost:3000 æŸ¥çœ‹åº”ç”¨ã€‚

## ğŸ“± åŠŸèƒ½ç‰¹æ€§

### æ‚£è€…ç«¯åŠŸèƒ½

- **è¿æ¥é’±åŒ…**ï¼šæ”¯æŒ MetaMask é’±åŒ…è¿æ¥
- **æ•°æ®ä¸Šä¼ **ï¼š
  - è¾“å…¥è¡€ç³–å€¼ (20-600 mg/dL)
  - é€‰æ‹©æµ‹é‡æ—¶é—´
  - æ·»åŠ å¤‡æ³¨ä¿¡æ¯
  - è‡ªåŠ¨ FHE åŠ å¯†å¤„ç†
- **æäº¤å†å²**ï¼šæŸ¥çœ‹å·²æäº¤çš„æ•°æ®è®°å½•
- **éšç§ä¿æŠ¤**ï¼šæ‰€æœ‰æ•°æ®å®Œå…¨åŠ å¯†ï¼Œæ— æ³•è¢«ç¬¬ä¸‰æ–¹è¯»å–

### ç ”ç©¶å‘˜ç«¯åŠŸèƒ½

- **æˆæƒéªŒè¯**ï¼šä»…æˆæƒç ”ç©¶å‘˜å¯è¿è¡Œåˆ†æ
- **åˆ†æç±»å‹**ï¼š
  - å¹³å‡å€¼åˆ†æï¼šè®¡ç®—è¡€ç³–å¹³å‡å€¼å’Œæ ‡å‡†å·®
  - åˆ†å¸ƒç»Ÿè®¡ï¼šåˆ†æè¡€ç³–å€¼åˆ†å¸ƒæƒ…å†µ
  - è¶‹åŠ¿åˆ†æï¼šæ—¶é—´åºåˆ—è¶‹åŠ¿åˆ†æ
- **æ•°æ®å¯è§†åŒ–**ï¼š
  - æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€æŠ˜çº¿å›¾
  - äº¤äº’å¼å›¾è¡¨å±•ç¤º
  - åˆ†ææ´å¯Ÿå’Œå»ºè®®
- **åˆ†æå†å²**ï¼šæŸ¥çœ‹å†å²åˆ†æè®°å½•

### æ ¸å¿ƒå®‰å…¨ç‰¹æ€§

- **åŒæ€åŠ å¯†**ï¼šä½¿ç”¨ FHEVM æŠ€æœ¯ï¼Œæ•°æ®åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å§‹ç»ˆåŠ å¯†
- **å»ä¸­å¿ƒåŒ–å­˜å‚¨**ï¼šåŸå§‹æ•°æ®å­˜å‚¨åœ¨ IPFSï¼Œç¡®ä¿æ•°æ®ä¸å¯ç¯¡æ”¹
- **é“¾ä¸ŠéªŒè¯**ï¼šæ‰€æœ‰æ“ä½œåœ¨åŒºå—é“¾ä¸Šå¯éªŒè¯å’Œè¿½æº¯
- **æƒé™æ§åˆ¶**ï¼šç ”ç©¶å‘˜éœ€è¦æˆæƒæ‰èƒ½è¿è¡Œåˆ†æ

## ğŸ”§ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
diabetes-fhe-dapp/
â”œâ”€â”€ contracts/                 # æ™ºèƒ½åˆçº¦
â”‚   â””â”€â”€ DiabetesAnalytics.sol
â”œâ”€â”€ scripts/                   # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ deploy.js
â”œâ”€â”€ test/                      # åˆçº¦æµ‹è¯•
â”‚   â””â”€â”€ DiabetesAnalytics.test.js
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ components/           # React ç»„ä»¶
â”‚   â”œâ”€â”€ contexts/             # Context æä¾›è€…
â”‚   â”œâ”€â”€ pages/                # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ styles/               # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”œâ”€â”€ hardhat.config.js         # Hardhat é…ç½®
â””â”€â”€ package.json
```

### æ™ºèƒ½åˆçº¦æ¥å£

#### ä¸»è¦å‡½æ•°

```solidity
// æ‚£è€…æäº¤æ•°æ®
function submitPatientData(
    einput encryptedGlucose,
    bytes calldata inputProof,
    string calldata ipfsCid,
    string calldata loincCode
) external

// ç ”ç©¶å‘˜è¯·æ±‚åˆ†æ
function requestAnalysis(uint8 analysisType) external payable

// è·å–ç»Ÿè®¡ä¿¡æ¯
function getStats() external view returns (uint256, uint256, uint256)
```

#### äº‹ä»¶

```solidity
event DataSubmitted(address indexed patient, string ipfsCid, uint256 timestamp);
event AnalysisRequested(address indexed researcher, uint256 requestId);
event AnalysisCompleted(uint256 indexed requestId, string resultCid);
```

### å‰ç«¯ç»„ä»¶è¯´æ˜

- **Layout.js**ï¼šåº”ç”¨å¸ƒå±€å’Œå¯¼èˆª
- **WalletContext.js**ï¼šé’±åŒ…è¿æ¥å’ŒçŠ¶æ€ç®¡ç†
- **ContractContext.js**ï¼šæ™ºèƒ½åˆçº¦äº¤äº’
- **ToastContext.js**ï¼šæ¶ˆæ¯æç¤ºç³»ç»Ÿ
- **AnalyticsChart.js**ï¼šæ•°æ®å¯è§†åŒ–ç»„ä»¶

## ğŸ§ª æµ‹è¯•

### è¿è¡Œåˆçº¦æµ‹è¯•

```bash
npm test
```

### æµ‹è¯•è¦†ç›–çš„åŠŸèƒ½

- åˆçº¦éƒ¨ç½²å’Œåˆå§‹åŒ–
- æ‚£è€…æ•°æ®æäº¤
- ç ”ç©¶å‘˜æˆæƒå’Œåˆ†æè¯·æ±‚
- äº‹ä»¶è§¦å‘å’Œæ•°æ®éªŒè¯

## ğŸŒ éƒ¨ç½²

### Sepolia æµ‹è¯•ç½‘éƒ¨ç½²

1. è·å– Sepolia æµ‹è¯•ç½‘ ETHï¼š
   - è®¿é—® [Sepolia Faucet](https://sepoliafaucet.com/)
   - è·å–æµ‹è¯• ETH

2. é…ç½® Infura æˆ– Alchemyï¼š
   - æ³¨å†Œå¹¶è·å– API Key
   - æ›´æ–° `SEPOLIA_RPC_URL`

3. éƒ¨ç½²åˆçº¦ï¼š
   ```bash
   npm run deploy
   ```

4. éªŒè¯åˆçº¦ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   npx hardhat verify --network sepolia <CONTRACT_ADDRESS>
   ```

### å‰ç«¯éƒ¨ç½²

æ¨èä½¿ç”¨ Vercel éƒ¨ç½²ï¼š

```bash
cd frontend
npm run build
```

æˆ–ä½¿ç”¨ Vercel CLIï¼š

```bash
vercel --prod
```

## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹

### æ‚£è€…ä¸Šä¼ æ•°æ®

1. è¿æ¥ MetaMask é’±åŒ…
2. åˆ‡æ¢åˆ° Sepolia æµ‹è¯•ç½‘
3. è¾“å…¥è¡€ç³–å€¼å’Œæµ‹é‡æ—¶é—´
4. ç‚¹å‡»"åŠ å¯†å¹¶ä¸Šä¼ æ•°æ®"
5. ç¡®è®¤äº¤æ˜“å¹¶ç­‰å¾…ä¸Šé“¾

### ç ”ç©¶å‘˜è¿è¡Œåˆ†æ

1. è¿æ¥å·²æˆæƒçš„ç ”ç©¶å‘˜é’±åŒ…
2. é€‰æ‹©åˆ†æç±»å‹ï¼ˆå¹³å‡å€¼/åˆ†å¸ƒ/è¶‹åŠ¿ï¼‰
3. æ”¯ä»˜åˆ†æè´¹ç”¨å¹¶æäº¤è¯·æ±‚
4. ç­‰å¾…åˆ†æå®Œæˆå¹¶æŸ¥çœ‹ç»“æœ

## ğŸ” éšç§å’Œå®‰å…¨

### æ•°æ®ä¿æŠ¤æœºåˆ¶

1. **å®¢æˆ·ç«¯åŠ å¯†**ï¼šæ•°æ®åœ¨ä¸Šä¼ å‰ä½¿ç”¨ FHEVM åŠ å¯†
2. **åŒæ€è®¡ç®—**ï¼šåˆ†æè¿‡ç¨‹ä¸­æ•°æ®å§‹ç»ˆä¿æŒåŠ å¯†çŠ¶æ€
3. **å»ä¸­å¿ƒåŒ–å­˜å‚¨**ï¼šåŸå§‹æ•°æ®å­˜å‚¨åœ¨ IPFSï¼Œæ— ä¸­å¿ƒåŒ–é£é™©
4. **é“¾ä¸ŠéªŒè¯**ï¼šæ‰€æœ‰æ“ä½œå¯åœ¨åŒºå—é“¾ä¸ŠéªŒè¯

### å®‰å…¨æœ€ä½³å®è·µ

- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- ä½¿ç”¨ç¡¬ä»¶é’±åŒ…å­˜å‚¨ç§é’¥
- åœ¨ä¸»ç½‘éƒ¨ç½²å‰è¿›è¡Œå……åˆ†æµ‹è¯•
- å®æ–½å¤šé‡ç­¾åç®¡ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: MetaMask è¿æ¥å¤±è´¥**
A: ç¡®ä¿å·²å®‰è£… MetaMask å¹¶åˆ‡æ¢åˆ° Sepolia æµ‹è¯•ç½‘

**Q: åˆçº¦äº¤äº’å¤±è´¥**
A: æ£€æŸ¥åˆçº¦åœ°å€æ˜¯å¦æ­£ç¡®ï¼Œè´¦æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿçš„ ETH

**Q: IPFS ä¸Šä¼ å¤±è´¥**
A: æ£€æŸ¥ Filebase é…ç½®ï¼Œæˆ–ä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼è¿›è¡Œæµ‹è¯•

**Q: åˆ†æç»“æœä¸æ˜¾ç¤º**
A: ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ‚£è€…æ•°æ®ï¼Œä¸”ç ”ç©¶å‘˜è´¦æˆ·å·²æˆæƒ

### è·å–å¸®åŠ©

- æŸ¥çœ‹ [Issues](../../issues) é¡µé¢
- é˜…è¯» [Wiki](../../wiki) æ–‡æ¡£
- è”ç³»é¡¹ç›®ç»´æŠ¤è€…

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ”¯æŒæ›´å¤šåˆ†æç®—æ³•
- [ ] é›†æˆæ›´å¤š IPFS ç½‘å…³
- [ ] æ·»åŠ ç§»åŠ¨ç«¯æ”¯æŒ
- [ ] å®ç°æ•°æ®å¸‚åœºåŠŸèƒ½
- [ ] æ”¯æŒå¤šç§åŠ å¯†è´§å¸æ”¯ä»˜
- [ ] æ·»åŠ  DAO æ²»ç†æœºåˆ¶

---

**å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚åœ¨å¤„ç†çœŸå®åŒ»ç–—æ•°æ®æ—¶ï¼Œè¯·ç¡®ä¿éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œéšç§ä¿æŠ¤è¦æ±‚ã€‚